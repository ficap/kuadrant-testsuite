# name, http and agents sections will be added via test
phases:
  - rampUp:
      increasingRate:
        duration: !param RAMP_UP_DURATION
        maxDuration: !param RAMP_UP_MAX_DURATION
        initialUsersPerSec: !param RAMP_UP_INITIAL_PER_SEC
        targetUsersPerSec: !param RAMP_UP_TARGET_PER_SEC
        isWarmup: false
        scenario:
          - loadCsv: &loadCsv
            - randomCsvRow:
                file: 'queries.csv'
                skipComments: true
                columns:
                  0: csvHostname
                  1: csvToken
                  2: csvPath
          - req: &req
            - template:
                pattern: Bearer ${csvToken}
                toVar: authorization
            - httpRequest:
                authority:
                  fromVar: csvHostname
                headers:
                  authorization:
                    fromVar: authorization
                GET:
                  fromVar: csvPath
                sync: true
                metric: throughput
  - steadyLoad:
      constantRate:
        duration: !param STEADY_LOAD_DURATION
        maxDuration: !param STEADY_LOAD_MAX_DURATION
        usersPerSec: !param STEADY_LOAD_REQS_PER_SEC
        startAfter:
          phase: rampUp
        scenario:
          - loadCsv: *loadCsv
          - req: *req